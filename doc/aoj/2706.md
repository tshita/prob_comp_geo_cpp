[ğŸ  Home](../../README.md)  |  [ğŸ”— AOJ 2706](https://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=2706&lang=jp)

# å•é¡Œï¼šå¹¾ä½•å•é¡Œã‚’è§£ã“ã†ï¼ˆLet's Solve Geometric Problemsï¼‰
æ­£ã®æ•´æ•° $p, q$ ãŒ10é€²æ³•ã§ä¸ãˆã‚‰ã‚Œã‚‹ã€‚æœ‰ç†æ•° $\frac{p}{q}$ ã‚’æœ‰é™å°æ•°ã§è¡¨ç¾ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ãª $b$ é€²æ³•ã®ä¸­ã§åŸºæ•°ãŒæœ€å°ã®ã‚‚ã®ã‚’æ±‚ã‚ã‚ˆã€‚

- $0 < p, q < 10^9$

# è§£æ³•
$\frac{p}{q}$ ãŒ $b$ é€²æœ‰é™å°æ•°ã¨ãªã‚‹ã¨ãã€ã‚ã‚‹ $k \in \mathbb{N}$ ãŒå­˜åœ¨ã—ã¦ $b^k \frac{p}{q}$ ãŒæ•´æ•°ã¨ãªã‚‹ã€‚ã™ãªã‚ã¡ã€ $b^k p$ ã¯ $q$ ã®å€æ•°ã§ã‚ã‚‹ã€‚ã—ãŸãŒã£ã¦ã€ã‚ã‚‹ $n \in \mathbb{Z}$ ãŒå­˜åœ¨ã—ã¦ $b^k p = n q$ ã¨æ›¸ã‘ã‚‹ã€‚ã“ã®ã¨ãã€ $p$ ã¨ $q$ ã¯äº’ã„ã«ç´ ã¨ãªã‚‹ã‚ˆã†ã«æœ€å°å…¬å€æ•°ã§ä¸¡è¾ºã‚’å‰²ã£ã¦ã‚‚ $b^k$ ã«å½±éŸ¿ãŒãªã„ã®ã§ã€ç°¡å˜ã®ãŸã‚ã« $p$ ã¨ $q$ ã¯äº’ã„ã«ç´ ã§ã‚ã‚‹ã¨ã™ã‚‹ã€‚

ã“ã®å¼ã‚’å¤‰å½¢ã—ã¦ $b^k = \frac{n q}{p}$ ã‚’è€ƒãˆã‚‹ã€‚å·¦è¾ºã¯è‡ªç„¶æ•°ã§ã€ $p$ ã¨ $q$ ã¯äº’ã„ã«ç´ ãªã®ã§ $n$ ã¯ $p$ ã®å€æ•°ã¨ãªã‚‹ã€‚ã™ãªã‚ã¡ã€é©å½“ãªæ•´æ•° $n'$ ã«å¯¾ã—ã¦ $b^k = n' q$ ã¨ãªã‚‹ã€‚  
$b$ ãŒæœ€å°ã¨ãªã‚‹ã‚ˆã†ã« $n'$ ã‚’ä¸Šæ‰‹ãé¸ã¶ã“ã¨ã‚’è€ƒãˆã‚‹ã€‚ $n' q$ ãŒå›ºå®šã•ã‚Œã¦ã„ãŸã¨ãã€æœ€å°ã® $b$ ã¯ $n' q$ ã‚’ç´ å› æ•°åˆ†è§£ã—ã¦å„æŒ‡æ•°ã‚’æŒ‡æ•°å…¨ä½“ã®æœ€å¤§å…¬ç´„æ•°ã§å‰²ã£ãŸå€¤ã¨ãªã‚‹ã€‚  ä¾‹ãˆã°ã€ $1728 = 2^6 3^3$ ã‚’è€ƒãˆã‚‹ã¨ã€æŒ‡æ•° $(6, 3)$ ã®æœ€å¤§å…¬ç´„æ•°ã¯ $3$ ã§å„æŒ‡æ•°ã‚’æœ€å¤§å…¬ç´„æ•°ã§å‰²ã‚‹ã¨ $(2, 1)$ ã¨ãªã‚Š $12 = 2^2 3$ ã¨ãªã‚‹ã€‚ã“ã‚Œã¯ $12^3 = 1728$ ã§ã€ $k$ ã¯æœ€å¤§å…¬ç´„æ•°ã«å¯¾å¿œã—ã¦ã„ã‚‹ã€‚

$b$ ã‚’æœ€å°ã¨ã™ã‚‹ã‚ˆã†ãª $n'$ ã¯ã€å„æŒ‡æ•°ãŒç­‰ã—ãã™ã‚‹ã‚ˆã†ã«é¸ã¶ã¨ã‚ˆã„ã€‚ä¾‹ãˆã° $q = 1728$ ã®ã¨ãã¯ $n' = 3^3$ ã‚’é¸ã¶ã¨ $n' q = 2^6 3^6 = 46656$ ã‹ã‚‰ $b = 6 = 2^1 3^1$ ã¨ãªã‚‹ã€‚

ä»¥ä¸Šã‚’ã¾ã¨ã‚ã‚‹ã¨ã€ $p, q$ ã®æœ€å¤§å…¬ç´„æ•°ã‚’ $d$ ã¨ã—ã¦ã€ $q / d$ ã‚’ç´ å› æ•°åˆ†è§£ã—ãŸã¨ãã®å„ç´ å› æ•°ã®ç©ãŒæ±‚ã‚ã‚‹ç­”ãˆã¨ãªã‚‹ã€‚

### ã²ã¨ã“ã¨
è¨ˆç®—å¹¾ä½•ã®å•é¡Œã§ã¯ãªã„ã‘ã©å•é¡Œåã ã‘ã§è§£ã„ã¦ã¿ãŸã€‚ä¸¸ã‚èª¤å·®ã¯è¨ˆç®—å¹¾ä½•ã‹ã‚‰åˆ‡ã‚Šé›¢ã›ãªã„ãƒˆãƒ”ãƒƒã‚¯ãªã®ã§â€¦ã€‚

---------------------------------------------------------------------------------------------

<details>
<summary>src/aoj/2706.cc ã‚’è¡¨ç¤º</summary>

```cpp
#include <iostream>
#include <numeric>
#include <vector>
#include <cmath>

using ll = long long;

template<class T>
std::vector<std::pair<T, T>> PrimeFactorization(T n) {
    std::vector<std::pair<T, T>> pf;
    T m = n;
    for (T i = 2; i * i <= n; ++i) {
        if (m % i != 0) continue;
        T cnt = 0;
        while (m % i == 0) { ++cnt; m /= i; }
        pf.emplace_back(std::make_pair(i, cnt));
    }
    if (1 < m) pf.emplace_back(std::make_pair(m, 1));

    return pf;
}

int main() {
  ll p, q;
  std::cin >> p >> q;

  q /= std::gcd(p, q);
  const auto pf = PrimeFactorization(q);

  ll ans = std::accumulate(pf.begin(), pf.end(), (ll)1, [](ll acc, const auto &pf_i) {
    return acc * pf_i.first;
  });

  std::cout << ans << std::endl;

  return 0;
}
```

</details>
