[ğŸ  Home](../../README.md)  |  [ğŸ”— AOJ 1422](https://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1422)

# å•é¡Œï¼šLoop of Chocolate
åŠå¾„ãŒç­‰ã—ã„ $n$ å€‹ã®çƒã®ä¸­å¿ƒåº§æ¨™ãŒä¸ãˆã‚‰ã‚Œã‚‹ã€‚  
çƒã¯ãƒ«ãƒ¼ãƒ—ã‚’ãªã™ã‚ˆã†ã«é€£çµã—ã¦ã„ã‚‹ã€‚ã™ãªã‚ã¡ã€ $k$ ç•ªç›®ã®çƒã¯ $k + 1$ ç•ªç›®ï¼ˆ $1 \le k < n$ ï¼‰ã®çƒã¨ãŠäº’ã„äº¤å·®ã—ã¦ã„ã‚‹ã€‚ã¾ãŸã€1 ç•ªç›®ã¨ $n$ ç•ªç›®ã®çƒã‚‚ãŠäº’ã„ã«äº¤å·®ã—ã¦ã„ã‚‹ã€‚ãŸã ã—ã€ãã®ä»–ã®ã©ã®çƒåŒå£«ã‚‚äº¤å·®ã—ã¦ã„ãªã„ã€‚  
$n$ å€‹ã®çƒã®å’Œï¼ˆUnionï¼‰ã®ä½“ç©ã‚’æ±‚ã‚ã‚ˆã€‚

---------------------------------------------------------------------------------------------
ï¼Šå•é¡Œæ–‡ã‹ã‚‰æ˜ã‚‰ã‹ã§ã¯ãªã„ãŒã€3ã¤ä»¥ä¸Šã®çƒã®å…±é€šéƒ¨åˆ†ã¯ç©ºã¨ã—ã¦æ±‚ã‚ã‚ˆã€‚

ã™ã¹ã¦æ•´æ•°å‹ã§ä¸ãˆã‚‰ã‚Œã‚‹ã€‚
- çƒã®å€‹æ•°ï¼š $4 \le n \le 100$
- çƒã®åŠå¾„ï¼š $2 \le r \le 100$
- $i$ ç•ªç›®ã®çƒã®ä¸­å¿ƒ $(x_i, y_i, z_i)$ ï¼š $-100 \le x_i, y_i, z_i \le 100$

  
# è§£æ³•
çƒã®é€£çµã®ä»•æ–¹ãŒç‰¹æ®Šãªã®ã§ã€å„çƒã®ä½“ç©ã®ç·å’Œã‹ã‚‰äº¤å·®ã™ã‚‹çƒåŒå£«ã®ä½“ç©ã‚’å¼•ãã¨ $n$ å€‹ã®çƒã®å’Œã®ä½“ç©ãŒæ±‚ã¾ã‚‹ã€‚ã©ã®çƒåŒå£«ãŒäº¤å·®ã™ã‚‹ã‹ã‚‚å•é¡Œã§ä¸ãˆã‚‰ãˆã¦ã„ã‚‹ã®ã§ $O(n)$ æ™‚é–“ã§æ±‚ã¾ã‚‹ã€‚  
ã‚ã¨ã¯çƒã®ä½“ç©ã¨ã€äº¤å·®ã™ã‚‹äºŒã¤ã®çƒã®å…±é€šéƒ¨åˆ†ã®ä½“ç©ãŒåˆ†ã‹ã‚Œã°ã‚ˆã„ã€‚

## çƒã®ä½“ç©
åŠå¾„ $r$ ã®çƒã®ä½“ç©ã¯ $\frac{4}{3} \pi r^3$ ã§ã‚ã‚‹ã€‚  

ä½“ç©ã¯ã€Œå›è»¢ä½“ã®ä½“ç©ã‚’æ±‚ã‚ã‚‹å…¬å¼ã€ã§æ±‚ã¾ã‚‹ï¼ˆ[é«˜æ ¡æ•°å­¦ã®ç¾ã—ã„ç‰©èªï¼šçƒã®ä½“ç©ã¨è¡¨é¢ç©ã®å…¬å¼ã®è¦šãˆæ–¹ãƒ»ç©åˆ†ã§ã®æ±‚ã‚æ–¹](https://manabitimes.jp/math/968)ï¼‰ã€‚  
å…·ä½“çš„ã«ã¯ã€ $y = \sqrt{r^2 - x^2}$ ã¨ $x = -r, x = r$ ã€ $x$ è»¸ã§å›²ã¾ã‚ŒãŸé ˜åŸŸã‚’ $x$ è»¸ã®ã¾ã‚ã‚Šã«å›è»¢ã•ã›ã¦ã§ãã‚‹å›³å½¢ã®ä½“ç©ã«ç­‰ã—ãã€

$\int_{-r}^{r} \pi \left( \sqrt{r^2 - x^2} \right)^2 dx$

ã‚’è¨ˆç®—ã™ã‚‹ã¨æ±‚ã¾ã‚‹ã€‚


## äºŒã¤ã®çƒã®å…±é€šéƒ¨åˆ†ã®ä½“ç©
äºŒã¤ã®çƒã®å…±é€šéƒ¨åˆ†ã®ä½“ç©ã¯ $\frac{2}{3} \pi (r - d / 2)^2 (2 r + d / 2)$ ã§ã€ *çƒå† ï¼ˆspherical capï¼‰* ã‚’ä½¿ç”¨ã™ã‚‹ã¨æ±‚ã¾ã‚‹ï¼ˆ[Wikipedia: çƒå† ](https://ja.wikipedia.org/wiki/%E7%90%83%E5%86%A0)ï¼‰ã€‚

---------------------------------------------------------------------------------------------

<details>
<summary>src/aoj/1422.cc ã‚’è¡¨ç¤º</summary>

```cpp
#include <iostream>
#include <iomanip>
#include <vector>
#include <cmath>


// --------------------8<------- start of main part of solution -------8<--------------------
const double PI = acos(static_cast<double>(-1.0));

class SolveLoopOfChocolate {
public:
    SolveLoopOfChocolate(const int _n, const int _r) : n(_n), r(_r) { spheres.reserve(n); }

    struct Point3 { int x, y, z; };
    const int n; // #sphere (4 <= n <= 100)
    const int r; // radius of spheres; all of them are same (2 <= r <= 100)
    std::vector<Point3> spheres; // center of spheres

    void AddSphere(int x, int y, int z) { spheres.emplace_back(Point3{x, y, z}); }

    double GetVolumeUnionSpheres() const {
        double volume = n * VolumeSphere();

        for (int i = 0; i + 1 < n; ++i) {
            volume -= VolumeIntersectSphere(Distance(spheres[i], spheres[i + 1]));
        }
        volume -= VolumeIntersectSphere(Distance(spheres[0], spheres[n - 1]));

        return volume;
    };

private:
    // distance of two sphere's center
    double Distance(const Point3 &s1, const Point3 &s2) const { 
        return std::hypot(s1.x - s2.x, s1.y - s2.y, s1.z - s2.z); 
    }

    // volume of a sphere of radius r
    double VolumeSphere() const { return PI * r * r * r * 4.0 / 3.0; }

    // volume of the intersection of two spheres when distance between their center is d
    double VolumeIntersectSphere(const double d) const {
        return PI * 2.0 / 3.0 * std::pow(r - 0.5 * d, 2) * (2.0 * r + 0.5 * d);
    }
};
// --------------------8<------- end of main part of solution   -------8<--------------------


int main() {
    std::cout << std::fixed << std::setprecision(8);
    std::cin.tie(0); std::ios::sync_with_stdio(false);

    int n, r;
    std::cin >> n >> r;
    auto solver = SolveLoopOfChocolate(n, r);
    for (int i = 0; i < n; ++i) {
        int x, y, z;
        std::cin >> x >> y >> z;
        solver.AddSphere(x, y, z);
    }

    std::cout << solver.GetVolumeUnionSpheres() << std::endl;

    return 0;
}
```

</details>
